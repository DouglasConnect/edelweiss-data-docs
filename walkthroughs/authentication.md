# API Authentication

The Edelweiss Data API uses bearer tokens in HTTP requests in order to authenticate the requester and to allow access to protected datasets.

For example, sending a bearer token with fetch request to list datasets:

```js
fetch(`${baseUrl}/datasets`, {
    headers: {
        'Authorization': `bearer ${token}`
    },
})
```
### Generate an access token using the Edelweiss Data CLI.

The cli tool is bundled as part of this repo. Here are the steps to check out the code and install dependencies:

```bash
# Clone this repo
git clone https://github.com/DouglasConnect/edelweiss-data-docs.git
cd edelweiss-data-docs

# Install dependencies
yarn install
```

Now you can generate an access token at any time by running this command from the root directory of this repo:

```bash
yarn run authenticate
```

The CLI responds with:

```
Visit this url in your web browser to sign into edelweiss:
https://edelweiss.eu.auth0.com/activate?user_code=XXXX-XXXX

Your authorization token is XXXX-XXXX
Waiting for authentication.....
```

Open the url in your web browser and follow the instructions to sign up or sign in. After you have signed in via the web browser, the CLI will print out the result:

- `access_token` - this is the bearer token for you to attach to all http requests.
- `expires_in` - the number of seconds until your access token expires; by default 86400 seconds.


Use the `--help` flag to see what options are available with the authenticate command:

```bash
yarn run authenticate -- --help
```

*Caution*: If you sign up with a new email/password then you will receive an email to let you validate your address.  Access tokens generated by the CLI tool are not valid until you have validated your email address.
